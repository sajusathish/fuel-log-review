<!DOCTYPE html>
<html>
<head>
  <title>Daily Fuel Log Review</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
      background: #f4f6f8;
    }
    h3 {
      text-align: center;
      margin-bottom: 30px;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    }
    th, td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: center;
      font-size: 14px;
    }
    th {
      background-color: #2c3e50;
      color: white;
      position: sticky;
      top: 0;
    }
    tr:nth-child(even) {
      background-color: #f9f9f9;
    }
    .buttons {
      margin-top: 30px;
      text-align: center;
    }
    button {
      padding: 12px 25px;
      margin: 0 15px;
      font-size: 16px;
      cursor: pointer;
      border: none;
      border-radius: 6px;
      transition: background-color 0.3s ease;
    }
    .approve { background-color: #27ae60; color: white; }
    .approve:hover { background-color: #219150; }
    .reject { background-color: #c0392b; color: white; }
    .reject:hover { background-color: #a93226; }
    .refresh { background-color: #2980b9; color: white; }
    .refresh:hover { background-color: #2471a3; }
    #statusText {
      margin-top: 20px;
      text-align: center;
      font-size: 16px;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h3>Daily Fuel Log Review - <span id="todayDate"></span></h3>
  <div class="buttons">
    <button class="refresh" id="refreshBtn">üîÑ Refresh Table</button>
    <button class="approve" id="approveBtn">‚úÖ Approve</button>
    <button class="reject" id="rejectBtn">‚ùå Reject</button>
  </div>
  <div id="statusText">Waiting for refresh...</div>
  <div id="tableContainer"></div>

  <script>
    document.getElementById("todayDate").textContent = new Date().toISOString().split("T")[0];

    const reviewer = new URLSearchParams(window.location.search).get("reviewer") || "unknown@domain.com";
    const githubRawURL = "https://raw.githubusercontent.com/sajusathish/fuel-log-review/main/RefreshedData";

    let lastTimestamp = "";

    async function getLastUpdatedHST() {
      const response = await fetch(githubRawURL, { cache: "no-store" });
      const html = await response.text();
      const match = html.match(/<!--Updated: (.*?)-->/);
      if (match) {
        const utc = new Date(match[1]);
        const hstTime = new Date(utc.getTime() - 10 * 60 * 60 * 1000);
        const formatted = hstTime.toLocaleString("en-US", { hour12: false }) + " HST";
        return { date: formatted, raw: match[1], content: html };
      }
      return null;
    }

    async function refreshTable() {
      document.getElementById("statusText").textContent = "üîÑ Refreshing... Please wait";
      const snapshot = await getLastUpdatedHST();
      if (!snapshot) {
        document.getElementById("statusText").textContent = "‚ö†Ô∏è Unable to read timesta
